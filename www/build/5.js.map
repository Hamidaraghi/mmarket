{"version":3,"sources":["../../src/pages/search/search.module.ts","../../src/pages/search/search.ts"],"names":[],"mappings":"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","file":"5.js","sourcesContent":["import { SearchPage } from './search';\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\n\r\n@NgModule({\r\n  declarations: [SearchPage],\r\n  imports: [IonicPageModule.forChild(SearchPage)],\r\n})\r\nexport class SearchPagePageModule { }\n\n\n// WEBPACK FOOTER //\n// ./src/pages/search/search.module.ts","import { WooCommerceProvider } from './../../providers/woo-commerce/woo-commerce';\nimport { LoadingController } from 'ionic-angular/components/loading/loading-controller';\nimport { Component, NgZone } from '@angular/core';\nimport { NavController, NavParams, ToastController, IonicPage } from 'ionic-angular';\nimport { NetworkInterface } from '@ionic-native/network-interface';\nimport { Storage } from '@ionic/storage';\n\n@IonicPage({})\n@Component({\n  selector: 'page-search',\n  templateUrl: 'search.html',\n})\nexport class SearchPage {\n  spinner: any;\n  searchQuery: string = \"\";\n  WooCommerce: any = {};\n  products: any[] = [];\n  page: number = 2;\n  showEmptyResault: boolean = false;\n  userId:number = 0;\n  userIp: string ='';\n\n\n  constructor(public navCtrl: NavController, public toastCtrl: ToastController, public navParams: NavParams,\n    public loadingCtrl: LoadingController, private ngZone: NgZone, public wp: WooCommerceProvider, private storage: Storage,\n    private networkInterface: NetworkInterface) {\n\n    console.log(this.navParams.get(\"searchQuery\"));\n    this.searchQuery = this.navParams.get(\"searchQuery\");\n\n    this.WooCommerce = wp.WooCommerce;\n\n\n    var promises = [];\n    \n    //get wifi ip\n    promises.push(this.networkInterface.getWiFiIPAddress()\n    .then(address => {\n      console.info(`WifiIP: ${address.ip}, Subnet: ${address.subnet}`)\n      this.userIp += `WifiIp: ${address.ip}, Subnet: ${address.subnet}`\n\n    })\n    .catch(error => console.error(`Unable to get IP: ${error}`)));\n    //get carrierIp\n    promises.push(this.networkInterface.getCarrierIPAddress()\n    .then(address =>{\n      console.info(`CarrierIP: ${address.ip}, Subnet: ${address.subnet}`)\n      this.userIp += `CarrierIP: ${address.ip}, Subnet: ${address.subnet}`\n    })\n    .catch(error => console.error(`Unable to get IP: ${error}`)));\n\n    \npromises.push( this.storage.get(\"userLoginInfo\").then((userLoginInfo) => {\n      if (userLoginInfo != null) {\n        this.userId = userLoginInfo.user.id\n\n      } else {\n        console.log(\"No user logged in\");\n        this.userId = 0;\n      }\n    }));\n\n    Promise.all(promises).then(()=>{\n      var saveSearchData = {search_term :this.searchQuery,user_id : this.userId ,ip : this.userIp }\n\n      this.wp.WooCommerce3.postAsync('sep/v1/search-stats', saveSearchData).then((data) => {\n        console.log('MMMMMMMMMMM', data.body)\n        let res = (JSON.parse(data.body));\n        console.log('SSSSSSSSEEEEEEEEEEEEEERRRRRRRRR',res);\n      })\n    })\n    \n\n    this.WooCommerce.getAsync(\"products?search=\" + this.searchQuery).then((searchdata => {\n      this.ngZone.run(() => {\n        this.products = JSON.parse(searchdata.body);\n      })\n\n      if (this.products.length == 0 || this.products.length == null) {\n        this.ngZone.run(() => {\n          this.showEmptyResault = true;\n        })\n\n      }\n    }), (error) => {\n      console.log(error);\n    }); // end of this.WooCommerce.getAsync\n\n  }// end of constructor\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad SearchPage');\n  }\n\n  loadMoreProducts(event) {\n\n    this.WooCommerce.getAsync(\"products?search=\" + this.searchQuery + \"&page=\" + this.page).then((searchData) => {\n      this.ngZone.run(() => {\n        this.products = this.products.concat(JSON.parse(searchData.body));\n      })\n\n      if (JSON.parse(searchData.body).length < 10) {\n        event.enable(false);\n\n        this.toastCtrl.create({\n          message: \"پایان ...\",\n          duration: 5000\n        }).present();\n      }\n      event.complete();\n      this.page++;\n    });\n  }\n\n  openProductPage(product) {\n    this.navCtrl.push('ProductDetails', { \"product\": product });\n\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/search/search.ts"],"sourceRoot":""}